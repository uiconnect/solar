<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>8 Minutes Energy: Installation Status</title>
	<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	<link href="/public/bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css" />
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
	<link href="/public/plugins/select2/select2.min.css" rel="stylesheet" type="text/css" />	
	<link href="/public/dist/css/8minutes.css" rel="stylesheet" type="text/css" />
	<!-- Select2: plugin for select box styling -->

	
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
	<style type="text/css">
		.popover{
			max-width:100%;
			height:200px;
			margin-left:200px;
		}
		.view{
			display: none;
		}		
	    #map {
			width: 350px;
			height: 200px;
		}
	</style>
</head>
<body class="container-fluid" style="background-color:#f0f0f0;">
<div class="row">
	<div class="col-xs-12 topHeader e-shadow1 bg-white" style="position:fixed; z-index:100; ">
		<div class="row">
			<div class="col-xs-11">
				<img src="/public/dist/img/logo_8minutes.png" alt="8Minutes Logo">
				<div class="pull-right grey" style="padding-top:20px;">
					<a href="user_dashboard.html" class="navInactive">My Dashboard</a>&#8226;
					<a href="user_explore.html" class="navInactive">Go Solar</a>&#8226;
					<a href="user_installation.html" class="navActive">My Installations</a>&#8226;
					<a href="user_referrals.html" class="navInactive">My Referrals</a>
				</div>
			</div>
			<div class="col-xs-1" style="padding-top:20px;">
				<div class="profileImg" style="background-image:url('/public/dist/img/me2.jpg');">&nbsp;</div>
				<div class="dropdown" style="display:inline;">
				  <a href="#" class="dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" style="border:0;">
				   <span class="caret"></span>
				  </a>
				  <ul class="dropdown-menu dropdown-menu-right" style="font-size:12px" aria-labelledby="dropdownMenu1">
				    <li><a href="user_profile.html">MY PROFILE</a></li>
				    <li><a href="user_contact.html">CONTACT <span style="font-weight:500;">8MINUTES</span></a></li>					
				    <li role="separator" class="divider"></li>
				    <li><a href="#" id="logout">LOGOUT</a></li>
				  </ul>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="row" style="background-color:#f8f8f8; padding:5px 50px; top:55px; position:fixed; border-bottom:1px solid #ddd; z-index:99; width:100%; height:78px;">
	<div class="col-xs-12 pad20">
		<div class="pull-right">
			View installation progress for
			<select class="select2" id="instalationList" name="order" style="width:300px;" >
				<option value="">Select</option>
			</select>
		</div>
	</div>
</div>
<div style="margin:160px;"></div>

<div class="view">
	<p style="margin:30px;">
	<!-- Design details -->
	<div class="row" style="margin:0;">
		<div class="col-sm-1"></div>
	  	<div class="col-sm-10" id="designList">
			<div class="box1">
				<div class="row" style="background-color:#f8f8f8;">
					<div class="col-xs-12">
						<h3 class="text-grey text-center" style="margin:20px 0; margin-bottom:10px;"><i class="fa fa-pencil mar-r10"></i>3D Drawing of Solar Installation</h3>
						<h4 style="margin:0; margin-bottom:20px;"></h4>
					</div>
				</div>
				<p style="margin:20px;">
				<div class="row">
				<div class="col-xs-7">
					<div class="text-center" !style="height:300px;">
						<h4 class="text-left"><b>Installation Design</b></h4>
						<img src="" alt="Installation Design" class="img1" style="width:100%;border:1px solid #ddd;">
						<h6><a href="#" download>Download</a></h6>
					</div>
				</div>
				<div class="col-xs-5 text-left">
					<!-- ><h4><b>Download</b><br><a href="#"><i class="fa fa-download mar-r5"></i>Your contract copy</a></h4>
					<hr style="border:1px solid #ddd;">-->
					<h4><b>Know Your Design</b></h4>
					<h5>Your Project Manager should have informed you of the following:
						<ul>
							<li style="margin:10px 0; margin-left:-20px;">Height of the System and visibility from the ground</li>
							<li style="margin:10px 0; margin-left:-20px;">If there is any drilling required on your roof</li>
							<li style="margin:10px 0; margin-left:-20px;">Waterproofing and safety of your roof</li>
							<li style="margin:10px 0; margin-left:-20px;">Designated Storage Area for Components</li>
							<li style="margin:10px 0; margin-left:-20px;">Access pathway to roof for component delivery</li>
						</ul>
					</h5>
				</div>
			</div>
		</div>
		<div class="col-sm-1"></div>
	</div>
	<div class="row">
		<div class="col-xs-12 text-center pad20">
			<button class="btn btn-warning" id="approve" style="width:200px;">Approve Designs</button>
		</div>
	</div>
</div>

<script src="/public/plugins/jQuery/jQuery-2.1.4.min.js" type="text/javascript"></script>
<script src="/public/dist/js/index.js"></script>
<!-- jQuery 1.12.4 -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<!-- Bootstrap 3.3.78.5463 JS -->
<script src="/public/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<!-- Select2: plugin for styling select boxes -->
<script src="/public/plugins/select2/select2.full.min.js" type="text/javascript"></script>
<!-- angular JS-->
<script src="/public/plugins/angular/angular.min.js"></script>
<script src="/public/dist/js/search.js"></script>
<!-- select2 -->
<script type="text/javascript">
$(function () {
	//Initialize Select2 Elements
	$(".select2").select2();
});
</script>
<script>
  function initialize() {
    var mapCanvas = document.getElementById('map');
    var mapOptions = {
      center: new google.maps.LatLng(44.5403, 78.5463),
      zoom: 8,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    var map = new google.maps.Map(mapCanvas, mapOptions)
  }
  google.maps.event.addDomListener(window, 'load', initialize);
</script> 
  </body>
</html>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div style="padding:20px;"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>
			<div class="modal-body" style="padding:0 50px;">
			<h3 id="myModalLabel">Thank you!</h3>
			We have received your request for <b>500 mw Solar panel installation with contract option 2 (95% upfront payment)</b>. An email has been sent to your registered email address for your reference.<br><br>
			Please note:<br><br>
			<ul>
				<li>In next couple of days, you will receive a detailed contract along installation details will be mailed to your registered address along with other instructions.</li>
				<li>Please sign it and send it back our registered address along with cheque for <i class="fa fa-rupee"></i><b>2,45,000</b> in the name of <b>8 Minutes Energy</b>.<li>
			</ul>
			For any further enquiries please contact: <b>+91-7822-094-340</b> or email us at: <a href="mailto:switch@8minutes.com">switch@8minutes.com</a>
			Regards,<br>
			<img src="/public/dist/img/logo_8minutes.png" style="width:150px;" alt="8Minutes Logo">
			</div>
			<div class="modal-footer" style="border-top:0;">
				<div class="text-center"><button type="button" class="btn btn-warning" onClick="document.location.href='user_installation1.html'">Close</button></div>
			</div>
		</div>
	</div>
</div>


<script type="text/javascript">
	
	$(function(){

		var List;

		var id;
		if(window.sessionStorage.id){
			id = window.sessionStorage.id;
		}else{
			id = window.location.hash.split("");
			id.shift();
			id = id.join('');
			window.sessionStorage.id = id;
		}



		$.ajax({
			url:"/api/installation/all",
			type:"POST",
			data:{token:window.sessionStorage.token},
            error: function () {
                //document.location.href = "admin_order-list.html"

            },
			success: function (list) {
				List = list;
				for(var i in list){
					var item = list[i];
					$("#instalationList").append($("<option value=\""+ item._id +"\" >"+(item.location || ("item - " + (i+1))) +"</option>"))
				}

				id =  $("#instalationList").val() || id;
				var item = List.filter(function (a) {
					return a._id == id;
				})[0] || false;

				if(item){
					
					[0,1,2,3].forEach(function (i) {
						var filePath = item.design[i].img && item.design[i].img.file;
						var ext = item.design[i].img && item.design[i].img.ext
						
						$(".img"+(i+1)).next().find("a").attr("href",filePath)

						if(ext == "pdf" || ext == "doc" ){
							$(".img"+(i+1)).attr("src","/public/dist/img/doc-icon.png")
						}else{
							$(".img"+(i+1)).attr("src",filePath)
						}
					})
					$(".view").show();
				}

				$("#instalationList option[value='" + id+"']").attr("selected","selected")
				$(".select2").select2();
			}

		});

		$("#instalationList").on("change", function () {
			$(".view").show();

			id =  $("#instalationList").val();
			var item = List.filter(function (a) {
				return a._id == id;
			})[0] || {};


			[0,1,2,3].forEach(function (i) {
				var filePath = item.design[i].img && item.design[i].img.file;
				var ext = item.design[i].img && item.design[i].img.ext
					
				$(".img"+(i+1)).next().find("a").attr("href",filePath)

				if(ext == "pdf" || ext == "doc" ){
					$(".img"+(i+1)).attr("src","/public/dist/img/doc-icon.png")
				}else{
					$(".img"+(i+1)).attr("src",filePath)
				}
			})
		})

		$("#approve").on("click",function (e) {
			$.ajax({
				url:"/api/installation/"+id,
				type:"PATCH",
				data:{approved_on:(new Date()).toString(),token:window.sessionStorage.token},
	            error: function () {
	                //document.location.href = "admin_order-list.html"

	            },
				success: function (list) {
					window.sessionStorage.id = id;
					document.location.href = "user_installation1.html#" + id;


					var statusData = {
					    status : "View_Installation_Progress",
					    token  : window.sessionStorage.token
					}
					$.ajax({
					    url:"/api/requirement/"+id,
					    type:"PATCH",
					    data:statusData,
					    success: function (d) {
					       //document.location.href = "user_proposal.html#"+id;
					       document.location.href = "user_installation1.html#"+id;
					    }
					});


				}

			});	
		})



		
	})
</script>