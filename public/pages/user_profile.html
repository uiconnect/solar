<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>8 Minutes Energy: My Profile</title>
	<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	<link href="/public/bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css" />
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
	<link href="/public/plugins/select2/select2.min.css" rel="stylesheet" type="text/css" />	
	<link href="/public/dist/css/8minutes.css" rel="stylesheet" type="text/css" />
	<!-- Select2: plugin for select box styling -->

	
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
	<style type="text/css">
		.popover{
			max-width:100%;
			height:200px;
			margin-left:200px;
		}		
	    #map {
			width: 350px;
			height: 200px;
		}
	</style>
</head>
<body class="container-fluid" style="background-color:#f0f0f0;">
<div class="row">
	<div class="col-xs-12 topHeader e-shadow1 bg-white" style="position:fixed; z-index:100; ">
		<div class="row">
			<div class="col-xs-11">
				<img src="/public/dist/img/logo_8minutes.png" alt="8Minutes Logo">
				<div class="pull-right grey" style="padding-top:20px;">
					<a href="user_dashboard.html" class="navInactive">My Dashboard</a>&#8226;
					<a href="user_explore.html" class="navInactive">Go Solar</a>&#8226;
					<a href="user_installation.html" class="navInactive">My Installations</a>&#8226;
					<a href="user_referrals.html" class="navInactive">My Referrals</a>
				</div>
			</div>
			<div class="col-xs-1" style="padding-top:20px;">
				<div class="profileImg" style="background-image:url('/public/dist/img/me2.jpg');">&nbsp;</div>
				<div class="dropdown" style="display:inline;">
				  <a href="#" class="dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" style="border:0;">
				   <span class="caret"></span>
				  </a>
				  <ul class="dropdown-menu dropdown-menu-right" style="font-size:12px" aria-labelledby="dropdownMenu1">
				    <li><a href="user_profile.html">MY PROFILE</a></li>
				    <li><a href="user_contact.html">CONTACT <span style="font-weight:500;">8MINUTES</span></a></li>					
				    <li role="separator" class="divider"></li>
				    <li><a href="#" id="logout">LOGOUT</a></li>
				  </ul>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="row" style="background-color:#f8f8f8; padding:5px 50px; top:55px; position:fixed; border-bottom:1px solid #ddd; z-index:99; width:100%; height:78px;">
	<div class="col-xs-12 pad20">
		<div class="pull-right">
			<h4 class="pull-right" id="editProfile"><a href="#" class="black"><i class="fa fa-pencil mar-r10"></i>&nbsp;Edit my profile</a></h4>
		</div>
	</div>
</div>
<p style="margin-top:180px;">
<div class="row" style="padding:0 50px; z-index:9999;">
	<div class="col-xs-12">
		<h3 class="text-grey text-center"><i class="fa fa-user	 mar-r10 orange"></i>
		<br><br>Your profile details</h3>
		<p style="margin-top:50px">
		<div class="row">
			<div class="col-sm-6" style="border-right:1px solid #ccc;">
				<div class="headingGroup text-grey"><i class="fa fa-map-o mar-r10"></i>Contact Details<h6 class="pull-right" style="display:inline;"></h6></div>
				<p style="padding:10px;">
				<div class="row">
					<div class="col-xs-5 tdLabel">Name</div>
					<div class="col-xs-7 tdData" id="name"></div>						
				</div>
				<p style="padding:5px;">
				<div class="row">
					<div class="col-xs-5 tdLabel">Correspondence Address</div>
					<div class="col-xs-7 tdData" id="address"></div>						
				</div>
				<p style="padding:5px;">					
				<div class="row">
					<div class="col-xs-5 tdLabel">Email</div>
					<div class="col-xs-7 tdData" id="email"></div>						
				</div>
				<p style="padding:5px;">
				<div class="row">
					<div class="col-xs-5 tdLabel">Contact</div>
					<div class="col-xs-7 tdData" id="contactno"></div>						
				</div>				
			</div>
			<div class="col-sm-6" >
				<div class="headingGroup text-grey"><i class="fa fa-key mar-r10"></i>8Minutes Portal Access Details<h6 class="pull-right" style="display:inline;"></h6></div>
				<p style="padding:10px;">
				<div class="row">
					<div class="col-xs-5 tdLabel">CUID</div>
					<div class="col-xs-7 tdData" id="cid"></div>						
				</div>
				<p style="padding:5px;">
				<div class="row">
					<div class="col-xs-5 tdLabel">Username</div>
					<div class="col-xs-7 tdData" id="Username"></div>						
				</div>
				<p style="padding:5px;">
				<div class="row">
					<div class="col-xs-5 tdLabel">Password</div>
					<div class="col-xs-7 tdData">*************</div>						
				</div>		
			</div>
		</div>
	</div>
</div>


<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			
			<div id="register" >
				<form action="javascript:void(0)" method="post" id="accInfo">
				
					<div style="padding:20px; background-color:#eee;">
						<h3 style="display:inline;">Go Solar: New User Registration</h3>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body" style="padding:0 50px;">
						<h3 id="myModalLabel"></h3>
						

						<div class="row">
							<div class="col-xs-4">
								New Password
							</div>
							<div class="col-xs-8">
								<input type="checkbox" id="samepassCheckbox" checked value="same" >
								<label for="samepassCheckbox">Same as previous</label>
								<input id="newPassword" style="display:none" type="password" class="form-control" style="width:100%;">
								<h6>New password</h6>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-4">
								Salutation
							</div>
							<div class="col-xs-8">
								<select class="select2" id="salutation" style="width:70px">
									<option value="Mr">Mr</option>
									<option value="Mrs">Mrs</option>
									<option value="Others">Others</option>
								</select>
								<br>
								<br>
							</div>
						</div>

						<div class="row">
							<div class="col-xs-4">
								Full Name
							</div>
							<div class="col-xs-8">
								<input placeholder="First Name" type="text" id="fname" class="form-control" style="width:45%;float:left;"> 
								<input placeholder="Last Name" type="text" id="lname" class="form-control" style="width:45%;float:right;">
								<br style="clear:both">
								<br>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-4">
								Email ID
							</div>
							<div class="col-xs-8">
								<input id="userEmail" type="email" class="form-control" style="width:100%;">
								<h6>This will be used for all your communications</h6>							
							</div>
						</div>
						<div class="row">
							<div class="col-xs-4">
								Mobile #
							</div>
							<div class="col-xs-8">
								<input id="phone" type="text" class="form-control" style="width:100%;">
								<h6>This will be used for all your communications</h6>
							</div>
						</div>								
						<div class="row">
							<div class="col-xs-4">
								Address (line 1) 
							</div>
							<div class="col-xs-8">
								<input id="address1" type="text" class="form-control" style="width:100%;">
								<br>
							</div>
						</div>								
						<div class="row">
							<div class="col-xs-4">
								Address (line 2) 
							</div>
							<div class="col-xs-8">
								<input id="address2" type="text" class="form-control" style="width:100%;">
								<br>
							</div>
						</div>

						<div class="row">
							<div class="col-xs-4">
								PIN
							</div>
							<div class="col-xs-8">
								<input id="pin" type="text" class="form-control" style="width:100%;">
								<br>
							</div>
						</div>

					</div>

					<div class="modal-footer" style="border-top:0;">
						<div class="text-center">
							<div class="text-center">
								<input type="submit" class="btn btn-warning login" value="Update">
								<h6>If you are an installer, please contact 8Minutes team for access.</h6>
							</div>
						</div>
					</div>


				</form>
			</div>



		</div>
	</div>
</div>
	
	
<!-- jQuery 1.12.4 -->
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<!-- Bootstrap 3.3.78.5463 JS -->
<script src="/public/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<!-- Select2: plugin for styling select boxes -->
<script src="/public/plugins/select2/select2.full.min.js" type="text/javascript"></script>
<!-- angular JS-->
<script src="/public/plugins/angular/angular.min.js"></script>
<script src="/public/dist/js/search.js"></script>
<script type="text/javascript">

$(function () {
	//Initialize Select2 Elements
	$(".select2").select2();
});
</script>
<script>
  function initialize() {
    var mapCanvas = document.getElementById('map');
    var mapOptions = {
      center: new google.maps.LatLng(44.5403, 78.5463),
      zoom: 8,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    var map = new google.maps.Map(mapCanvas, mapOptions)
  }
  google.maps.event.addDomListener(window, 'load', initialize);
</script>



<script type="text/javascript">
	var userData;
	$(function(){
		$.ajax({
			url:"/api/user/userdetails",
			type:"POST",
			data:{token:window.sessionStorage.token},
			success: function (d) {
				userData = d;
				updateData(userData)
			}
		})
	});

	function updateData(d){
		$("#Username").html(d.username);
		$("#email").html(d.email);
		$("#contactno").html(d.phone);
		$("#address").html(d.address1+"<br>"+d.address2+"<br>"+(d.address3 || "")+"<br>"+(d.pin || ""));
		$("#cid").html(d.cid);
		$("#name").html(d.salutation+" "+d.fname+" "+d.lname);
	}

	$("#editProfile").on("click", function(){
		$("#myModal").modal("show");

		$("#fname").val(userData.fname)
		$("#lname").val(userData.lname)
		$("#userEmail").val(userData.email)
		$("#phone").val(userData.phone)
		$("#address1").val(userData.address1)
		$("#address2").val(userData.address2)
		$("#pin").val(userData.pin)

	})
	$("#samepassCheckbox").on("change", function(){
		if($(this).is(":checked")){
			$("#newPassword").hide()
		}else{
			$("#newPassword").show()
		}
	});

	$("#accInfo").on("submit",function(){
		var data = {
			fname : $("#fname").val(),
			username: userData.username,
			lname : $("#lname").val(),
			email : $("#userEmail").val(),
			phone : $("#phone").val(),
			salutation : $("#salutation").val(),
			newpassword : $("#newPassword").val(),
			address1 : $("#address1").val(),
			address2 : $("#address2").val(),
			pin : $("#pin").val(),
			token:window.sessionStorage.token
		};

		$.ajax({
			url:"/api/user/userdetails",
			type:"PATCH",
			data:data,
			success: function (d) {
				window.sessionStorage.token = d.token
				$("#myModal").modal("hide");	
				updateData(data)	
			}
		})
	})
</script>
<script src="/public/dist/js/index.js"></script>

</body>
</html>
